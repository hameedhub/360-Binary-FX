var Converter=function(){return{from_id:0,to_id:0,init:function(){$.get('/searchable_items_json?converter=1','json',function(data){var converter_search_options={source:data,autoSelect:true,items:3,afterSelect:function(item){if(this.$element[0].id=='converter_from'){Converter.from_id=item.id;}else
if(this.$element[0].id=='converter_to'){Converter.to_id=item.id;}},highlighter:function(item){return item;},sorter:function(items){var symbolBegins=[];var nameBegins=[];var contains=[];var query=this.query.toLowerCase();var item;while((item=items.shift())){var symbol=item.symbol.toLowerCase();var name=item.name.toLowerCase();if(symbol.indexOf(query)==0){symbolBegins.push(item);}else if(name.indexOf(query)==0){nameBegins.push(item);}else{contains.push(item);}}
return symbolBegins.concat(nameBegins,contains);}}
$('#converter_from').typeahead(converter_search_options);$('#converter_to').typeahead(converter_search_options);$('#converter input.form-control').prop('disabled',false);$('#converter button').prop('disabled',false);});},convert:function(){if(Converter.from_id==0){$('#conversion').html('<span class="text-danger">Please enter the From currency</span>');return;}
if(Converter.to_id==0){$('#conversion').html('<span class="text-danger">Please enter the To currency</span>');return;}
if(Converter.to_id==Converter.from_id){$('#conversion').html('<span class="text-danger">Please select different currencies</span>');return;}
$('#conversion').html('<i class="fal fa-spin fa-spinner"></i>');$.ajax({type:'POST',url:'/get_price',data:'coin1='+Converter.from_id+'&coin2='+Converter.to_id,dataType:'json'}).done(function(data){amount=parseFloat($('#converter_amount').val());if(!amount){amount=1;}
converted=format_price(data.price*amount);s='<b>'+amount+' '+data.coin1_symbol+' = '+converted+' '+data.coin2_symbol+'</b>';s+='<br><span class="smaller">More precisely: '+format_price_exact(data.price*amount)+'</span>';$('#conversion').html(s);$('input[name=ppc]').val();});}};}();